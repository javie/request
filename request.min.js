(function(){var c,f,e,d,g,a,b;a=typeof exports!=="undefined"&&exports!==null?exports:this;g={};d=null;if(typeof a.Javie==="undefined"){throw new Error("Javie is missing");
}if(typeof a.Javie.EventDispatcher==="undefined"){throw new Error("Javie.EventDispatcher is missing");}d=a.Javie.EventDispatcher.make();b=a._;if(!b&&(typeof require!=="undefined"&&require!==null)){b=require("underscore");
}if(!b){throw new Error("underscore.js is missing");}e=a.$;if(typeof e==="undefined"||e===null){throw new Error("Required jQuery or Zepto object is missing");
}c=(function(){var i;function h(){}i=function(j){if(b.isString(j)===true){j=e.parseJSON(j);}return j;};h.prototype.executed=false;h.prototype.config={name:"",type:"GET",uri:"",query:"",data:"",dataType:"json",id:"",object:null};
h.prototype.get=function(j,k){if(typeof this.config[j]!=="undefined"){return this.config[j];}return k!=null?k:k=null;};h.prototype.put=function(k,l){var j;
j=k;if(!b.isObject(k)){j={key:l};}return this.config=b.defaults(j,this.config);};h.prototype.to=function(j,m,r){var k,o,n,p,q,l;this.put({dataType:r!=null?r:r="json"});
n=["POST","GET","PUT","DELETE"];if(b.isUndefined(j)){throw new Error("Missing required url parameter");}if(m!=null){m=a.document;}p=j.split(" ");if(p.length===1){l=p[0];
}else{if(b.indexOf(n,p[0])!==-1){q=p[0];}l=p[1];if(q!=="GET"){o=l.split("?");if(o.length>1){j=o[0];this.put("query",o[1]);}}l=l.replace(":baseUrl",this.get("baseUrl",""));
this.put({type:q,uri:l});}k=e(this.get("object")).attr("id");if(typeof k!=="undefined"){this.put({id:"#"+k});}return this;};h.prototype.execute=function(m){var k,l,j;
j=this;k=this.get("name");if(!b.isObject(m)){m=""+(e(this.get("object")).serialize())+"&"+(this.get("query"));if(m==="?&"){m="";}}this.executed=true;d.fire("Request.beforeSend",[this]);
d.fire("Request.beforeSend: "+k,[this]);this.config.beforeSend(this);l={type:this.get("type"),dataType:this.get("dataType"),url:this.get("uri"),data:m,complete:function(o){var n;
m=i(o.responseText);n=o.status;if(!b.isUndefined(m)&&m.hasOwnProperty("errors")){d.fire("Request.onError",[m.errors,n,j]);d.fire("Request.onError: "+k,[m.errors,n,j]);
j.config.onError(m.errors,n,j);m.errors=null;}d.fire("Request.onComplete",[m,n,j]);d.fire("Request.onComplete: "+k,[m,n,j]);j.config.onComplete(m,n,j);
return true;}};e.ajax(l);return this;};return h;})();f=(function(){var h;h=function(k){var n,j,l,m;m=null;if(!b.isUndefined(g[k])){l=g[k];if(l.executed===true){j=b.uniqueId(""+k+"_");
n=new c;d.clone("Request.onError: "+k).to("Request.onError: "+j);d.clone("Request.onComplete: "+k).to("Request.onComplete: "+j);d.clone("Request.beforeSend: "+k).to("Request.beforeSend: "+j);
n.put(l.config);m=n;}m=l;}else{m=new c;m.config=b.defaults(m.config,i.config);m.put({name:k});g[k]=m;}return m;};function i(j){return i.make(j);}i.make=function(j){if(!b.isString(j)){j="default";
}return h(j);};i.config={baseUrl:null,onError:function(k,j){},beforeSend:function(k,j){},onComplete:function(k,j){}};i.get=function(j,k){if(k==null){k=null;
}if(b.isUndefined(this.config[j])){return k;}return this.config[j];};i.put=function(k,l){var j;j=k;if(!b.isObject(k)){j={key:l};}return this.config=b.defaults(j,this.config);
};return i;})();if(typeof exports!=="undefined"&&exports!==null){if((typeof module!=="undefined"&&module!==null)&&module.exports){module.exports=f;}a.Request=f;
}else{a.Javie.Request=f;}}).call(this);