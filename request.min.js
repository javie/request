(function(){var a,b,e,i,f,c,d,g,h;g=typeof exports!=="undefined"&&exports!==null?exports:this;c={};i=null;if(typeof g.Javie==="undefined"){throw new Error("Javie is missing");
}if(typeof g.Javie.EventDispatcher==="undefined"){throw new Error("Javie.EventDispatcher is missing");}i=g.Javie.EventDispatcher.make();h=g._;if(!h&&(typeof require!=="undefined"&&require!==null)){h=require("underscore");
}if(!h){throw new Error("underscore.js is missing");}e=g.$;if(typeof e==="undefined"||e===null){throw new Error("Required jQuery or Zepto object is missing");
}d=function(j){if(h.isString(j)===true){j=e.parseJSON(j);}return j;};f=function(l){var o,k,j,m,n;n=null;if(typeof c[l]!=="undefined"){m=c[l];if(m.executed===true){k=h.uniqueId(""+l+"_");
o=new a;i.clone("Request.onError: "+l).to("Request.onError: "+k);i.clone("Request.onComplete: "+l).to("Request.onComplete: "+k);i.clone("Request.beforeSend: "+l).to("Request.beforeSend: "+k);
o.put(m.config);j=o;}j=m;}else{j=new a;j.config=h.defaults(j.config,b.config);c[l]=j;}return j;};a=(function(){function j(){}j.prototype.executed=false;
j.prototype.config={name:"",type:"GET",uri:"",query:"",data:"",dataType:"json",id:"",object:null};j.prototype.get=function(k,l){if(typeof this.config[k]!=="undefined"){return this.config[k];
}return l!=null?l:l=null;};j.prototype.put=function(l,m){var k;k=l;if(!h.isString(l)){k={key:value};}return this.config=h.defaults(k,this.config);};j.prototype.to=function(m,l,r){var k,n,q,o,p;
if(r==null){r="json";}n=["POST","GET","PUT","DELETE"];if(typeof m==="undefined"){throw new Error("Missing required url parameter");}if(l==null){l=g.document;
}q=m.split(" ");this.put({name:name,dataType:r});if(q.length===1){p=q[0];}else{if(h.indexOf(n,q[0])===true){o=q[0];}p=q[1];if(o!=="GET"){k=p.split("?");
if(k.length>1){m=k[0];this.put("query",k[1]);}}p=p.replace(":baseUrl",this.get("baseUrl",""));this.put({type:o,uri:p});}this.put("id","#"+(e(this.get("object")).attr("id")));
return this;};j.prototype.execute=function(){var m,l,k;k=this;m=""+(e(this.get("object")).serialize())+"&"+(this.get("query"));if(m==="?&"){m="";}this.execute=true;
i.fire("Request.beforeSend",[this]);i.fire("Request.beforeSend: "+name,[this]);this.config.beforeSend(this);l={type:this.get("type"),dataType:this.get("dataType"),url:this.get("uri"),data:m,complete:function(o){var n;
m=d(o.responseText);n=o.status;if(typeof m!=="undefined"&&m.hasOwnProperty("errors")){i.fire("Request.onError",[m.errors,n,k]);i.fire("Request.onError: "+name,[m.errors,n,k]);
this.config.onError(m.errors,n,k);m.errors=null;}i.fire("Request.onComplete",[m,n,k]);i.fire("Request.onComplete: "+name,[m,n,k]);this.config.onComplete(m,n,k);
return true;}};e.ajax(l);return true;};return j;})();b=(function(){function j(k){return j.make(k);}j.config={baseUrl:null,onError:function(l,k){},beforeSend:function(l,k){},onComplete:function(l,k){}};
j.get=function(k,l){if(l==null){l=null;}if(typeof this.config[k]==="undefined"){return l;}return this.config[k];};j.put=function(l,m){var k;k=l;if(!h.isObject(k)){k={};
k[l.toString()]=m;}return this.config=h.defaults(k,this.config);};j.make=function(k){if(!h.isString(k)){k="default";}return f(k);};return j;})();if(typeof exports!=="undefined"&&exports!==null){if((typeof module!=="undefined"&&module!==null)&&module.exports){module.exports=b;
}g.Request=b;}else{g.Javie.Request=b;}}).call(this);