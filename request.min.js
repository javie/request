(function(){var e,t,n,r,i,o,u;if(o="undefined"!=typeof exports&&null!==exports?exports:this,i={},r=null,"undefined"==typeof o.Javie)throw new Error("Javie is missing");
if("undefined"==typeof o.Javie.EventDispatcher)throw new Error("Javie.EventDispatcher is missing");if(r=o.Javie.EventDispatcher.make(),u=o._,u||"undefined"==typeof require||null===require||(u=require("underscore")),!u)throw new Error("underscore.js is missing");
if(n=o.$,"undefined"==typeof n||null===n)throw new Error("Required jQuery or Zepto object is missing");e=function(){function e(){}var t;return t=function(e){var t;
if(u.isString(e)===!0)try{e=n.parseJSON(e)}catch(r){t=r}return e},e.prototype.executed=!1,e.prototype.response=null,e.prototype.config={name:"",type:"GET",uri:"",query:"",data:"",dataType:"json",id:"",object:null},e.prototype.get=function(e,t){return"undefined"!=typeof this.config[e]?this.config[e]:null!=t?t:t=null
},e.prototype.put=function(e,t){var n;return n=e,u.isObject(e)||(n={key:t}),this.config=u.defaults(n,this.config)},e.prototype.to=function(e,t,r){var i,s,f,p,l,c;
if(this.put({dataType:null!=r?r:r="json"}),f=["POST","GET","PUT","DELETE"],u.isUndefined(e))throw new Error("Missing required url parameter");return null!=t&&(t=o.document),p=e.split(" "),1===p.length?c=p[0]:(-1!==u.indexOf(f,p[0])&&(l=p[0]),c=p[1],"GET"!==l&&(s=c.split("?"),s.length>1&&(e=s[0],this.put("query",s[1]))),c=c.replace(":baseUrl",this.get("baseUrl","")),this.put({type:l,uri:c})),i=n(this.get("object")).attr("id"),"undefined"!=typeof i&&this.put({id:"#"+i}),this
},e.prototype.execute=function(e){var i,o,s;return i=this,o=this.get("name"),u.isObject(e)||(e=""+n(this.get("object")).serialize()+"&"+this.get("query"),"?&"===e&&(e="")),this.executed=!0,r.fire("Request.beforeSend",[this]),r.fire("Request.beforeSend: "+o,[this]),this.config.beforeSend(this),s={type:this.get("type"),dataType:this.get("dataType"),url:this.get("uri"),data:e,complete:function(n){var s;
return e=t(n.responseText),s=n.status,i.response=n,!u.isUndefined(e)&&e.hasOwnProperty("errors")&&(r.fire("Request.onError",[e.errors,s,i]),r.fire("Request.onError: "+o,[e.errors,s,i]),i.config.onError(e.errors,s,i),e.errors=null),r.fire("Request.onComplete",[e,s,i]),r.fire("Request.onComplete: "+o,[e,s,i]),i.config.onComplete(e,s,i),!0
}},n.ajax(s),this},e}(),t=function(){function t(e){return t.make(e)}var n;return n=function(n){var o,s,f,p;return p=null,u.isUndefined(i[n])?(p=new e,p.config=u.defaults(p.config,t.config),p.put({name:n}),i[n]=p):(f=i[n],f.executed===!0&&(s=u.uniqueId(""+n+"_"),o=new e,r.clone("Request.onError: "+n).to("Request.onError: "+s),r.clone("Request.onComplete: "+n).to("Request.onComplete: "+s),r.clone("Request.beforeSend: "+n).to("Request.beforeSend: "+s),o.put(f.config),p=o),p=f),p
},t.make=function(e){return u.isString(e)||(e="default"),n(e)},t.config={baseUrl:null,onError:function(){},beforeSend:function(){},onComplete:function(){}},t.get=function(e,t){return null==t&&(t=null),u.isUndefined(this.config[e])?t:this.config[e]
},t.put=function(e,t){var n;return n=e,u.isObject(e)||(n={key:t}),this.config=u.defaults(n,this.config)},t}(),"undefined"!=typeof exports&&null!==exports?("undefined"!=typeof module&&null!==module&&module.exports&&(module.exports=t),o.Request=t):o.Javie.Request=t
}).call(this);