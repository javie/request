(function(){var d,f,e,c,g,a,b;a=typeof exports!=="undefined"&&exports!==null?exports:this;g={};c=null;if(typeof a.Javie==="undefined"){throw new Error("Javie is missing");
}if(typeof a.Javie.EventDispatcher==="undefined"){throw new Error("Javie.EventDispatcher is missing");}c=a.Javie.EventDispatcher.make();b=a._;if(!b&&(typeof require!=="undefined"&&require!==null)){b=require("underscore");
}if(!b){throw new Error("underscore.js is missing");}e=a.$;if(typeof e==="undefined"||e===null){throw new Error("Required jQuery or Zepto object is missing");
}d=(function(){var i;function h(){}i=function(j){if(b.isString(j)===true){j=e.parseJSON(j);}return j;};h.prototype.executed=false;h.prototype.config={name:"",type:"GET",uri:"",query:"",data:"",dataType:"json",id:"",object:null};
h.prototype.get=function(j,k){if(typeof this.config[j]!=="undefined"){return this.config[j];}return k!=null?k:k=null;};h.prototype.put=function(k,l){var j;
j=k;if(!b.isObject(k)){j={key:l};}return this.config=b.defaults(j,this.config);};h.prototype.to=function(l,k,q){var j,m,p,n,o;if(q==null){q="json";}m=["POST","GET","PUT","DELETE"];
if(typeof l==="undefined"){throw new Error("Missing required url parameter");}if(k==null){k=a.document;}p=l.split(" ");this.put({name:name,dataType:q});
if(p.length===1){o=p[0];}else{if(b.indexOf(m,p[0])===true){n=p[0];}o=p[1];if(n!=="GET"){j=o.split("?");if(j.length>1){l=j[0];this.put("query",j[1]);}}o=o.replace(":baseUrl",this.get("baseUrl",""));
this.put({type:n,uri:o});}this.put("id","#"+(e(this.get("object")).attr("id")));return this;};h.prototype.execute=function(){var l,k,j;j=this;l=""+(e(this.get("object")).serialize())+"&"+(this.get("query"));
if(l==="?&"){l="";}this.executed=true;c.fire("Request.beforeSend",[this]);c.fire("Request.beforeSend: "+name,[this]);this.config.beforeSend(this);k={type:this.get("type"),dataType:this.get("dataType"),url:this.get("uri"),data:l,complete:function(n){var m;
l=i(n.responseText);m=n.status;if(typeof l!=="undefined"&&l.hasOwnProperty("errors")){c.fire("Request.onError",[l.errors,m,j]);c.fire("Request.onError: "+name,[l.errors,m,j]);
j.config.onError(l.errors,m,j);l.errors=null;}c.fire("Request.onComplete",[l,m,j]);c.fire("Request.onComplete: "+name,[l,m,j]);j.config.onComplete(l,m,j);
return true;}};e.ajax(k);return this;};return h;})();f=(function(){var h;h=function(k){var n,j,l,m;m=null;if(typeof g[k]!=="undefined"){l=g[k];if(l.executed===true){j=b.uniqueId(""+k+"_");
n=new d;c.clone("Request.onError: "+k).to("Request.onError: "+j);c.clone("Request.onComplete: "+k).to("Request.onComplete: "+j);c.clone("Request.beforeSend: "+k).to("Request.beforeSend: "+j);
n.put(l.config);m=n;}m=l;}else{m=new d;m.config=b.defaults(m.config,i.config);g[k]=m;}return m;};function i(j){return i.make(j);}i.make=function(j){if(!b.isString(j)){j="default";
}return h(j);};i.config={baseUrl:null,onError:function(k,j){},beforeSend:function(k,j){},onComplete:function(k,j){}};i.get=function(j,k){if(k==null){k=null;
}if(typeof this.config[j]==="undefined"){return k;}return this.config[j];};i.put=function(k,l){var j;j=k;if(!b.isObject(j)){j={};j[k.toString()]=l;}return this.config=b.defaults(j,this.config);
};return i;})();if(typeof exports!=="undefined"&&exports!==null){if((typeof module!=="undefined"&&module!==null)&&module.exports){module.exports=f;}a.Request=f;
}else{a.Javie.Request=f;}}).call(this);