(function(){var k,b,m,h,j,g;k=this;b=function(n){return b.make(n);};g={};if("undefined"!==typeof exports){throw new Error("Not supported");}if("undefined"===typeof k.Javie){throw new Error("Javie is required before using Javie.Request");
}k.Javie.Request=b;if("undefined"===typeof k.Javie.Events){throw new Error("Javie is missing Logger and Events");}j=k.Javie.Events.make();m=k._;if(!m&&"undefined"!==typeof require){m=require("underscore");
}h=k.$;if("undefined"===typeof h||null===h){throw new Error("Required jQuery or Zepto object is not available.");}function e(n){if(m.isString(n)){n=h.parseJSON(n);
}return n;}b.config={baseUrl:null,onError:function f(o,n){},beforeSend:function l(o,n){},onComplete:function d(o,n){}};b.put=function i(o,p){var n=(!m.isString(o))?o:{key:p};
this.config=m.defaults(n,this.config);};b.get=function c(o,n){if(!m.isSet(n)){n=null;}if(!m.isSet(this.config[o])){return n;}return this.config[o];};b.make=function a(o){var n,p,v,u,w;
if(!m.isString(o)){o="default";}w=this;if(!m.isUndefined(g[o])){u=g[o];if(u.executed===true){v=m.uniqueId(o+"_");p=w.make(v);j.clone("Request.onError: "+o).to("Request.onError: "+v);
j.clone("Request.onComplete: "+o).to("Request.onComplete: "+v);j.clone("Request.beforeSend: "+o).to("Request.beforeSend: "+v);p.put(u.config);return p;
}return u;}n={executed:false,to:function t(A,z,y){var x,E,C,D,B;x=this;if(m.isUndefined(A)){throw new Error("Missing required parameter.");}if(m.isNull(z)){z=k.document;
}E=A.split(" ");C="GET";x.put({name:o,type:"GET",query:"",data:"",dataType:(!m.isUndefined(y)?y:"json"),id:"",object:z});if(E.length===1){D=E[0];}else{if(m.indexOf(["POST","GET","PUT","DELETE"],E[0])>-1){C=E[0];
}D=E[1];if(C!=="GET"){B=D.split("?");if(B.length>1){D=B[0];x.put("query",B[1]);}}D=D.replace(":baseUrl",w.get("baseUrl",""));x.put({type:C,uri:D});}x.put("id","#"+h(x.get("object")).attr("id"));
return this;},execute:function s(){var y,z;y=this;z=h(y.get("object")).serialize()+"&"+y.get("query");if(z==="?&"){z="";}y.executed=true;j.fire("Request.beforeSend",[y]);
j.fire("Request.beforeSend: "+o,[y]);y.config.beforeSend(y);h.ajax({type:y.get("type"),dataType:y.get("dataType"),url:y.get("uri"),data:z,complete:function x(C){var B,A;
if(C.responseText!==""){B=e(C.responseText);A=C.status;if(B.hasOwnProperty("errors")){j.fire("Request.onError",[B.errors,A,y]);j.fire("Request.onError: "+o,[B.errors,A,y]);
y.config.onError(B.errors,A,y);B.errors=null;}j.fire("Request.onComplete",[B,A,y]);j.fire("Request.onComplete: "+o,[B,A,y]);y.config.onComplete(B,A,y);
}}});},config:{name:"",type:"GET",uri:"",query:"",data:"",dataType:"json",id:"",object:null},put:function r(y,z){var x=(!m.isString(y)?y:{key:z});this.config=m.defaults(x,this.config);
},get:function q(x,y){if(m.isUndefined(y)){y=null;}return(!m.isUndefined(this.config[x])?this.config[x]:y);}};n.config=m.defaults(n.config,w.config);g[o]=n;
return g[o];};}).call(this);